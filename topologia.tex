\begin{tad}{\tadNombre{TopologÃ­a}}

\tadGeneros{topo}
\tadExporta {topo, observadores, generadores, otrasoperaciones}
\tadUsa {nat, bool, compu, conexion}

\tadAlinearFunciones{AgregarComputadora}{conj(compu), compu, compu}

\tadObservadores
\tadOperacion{computadoras}{topo}{conj(interfaz)}{}
\tadOperacion{conexiones}{topo}{conj(conexion)}{}
\tadOperacion{quitarConexion}{topo, conexion}{topo}{}


\tadGeneradores

\tadOperacion{Vacia}{}{topo}{}
\tadOperacion{AgregarComputadora}{topo, compu}{topo}{}
\tadOperacion{AgregarConexion}{topo, conexion}{topo}{}

\tadOtrasOperaciones

\tadOperacion{vecinos}{topo, compu}{conj(compu)}{}
\tadOperacion{dameConexion}{topo, compu, compu}{conexion}{}
\tadOperacion{caminosDeLargoN}{topo, compu, nat}{conj(compu)}{}

\tadOperacion{esCamino}{conj(compu), compu, compu}{bool}{}
\tadOperacion{filtrarCaminos}{conj(compu), compu, compu}{conj(compu)}{}
\tadOperacion{caminoMasCortoDeLargoN}{topo, compu, compu, nat}{conj(compu)}{}
\tadOperacion{caminoMasCorto}{topo, compu, compu}{conj(compu)}{}

\tadAxiomas {\paratodo{nat}{n}, \paratodo{conj(conexion)}{ccon}, \paratodo{compu}{c,c'}}

\tadAxioma{computadoras(Vacia)}{Vacio}
\tadAxioma{computadoras(AgregarComputadora($top$,$compu$)}{Ag($compu$,computadoras($top$)}
\tadAxioma{computadoras(AgregarConexion($top$,$conx$)}{computadoras($top$)}

\tadAxioma{conexiones(Vacia)}{Vacio}
\tadAxioma{conexiones(AgregarComputadora($top$,$compu$)}{conexiones($top$)}
\tadAxioma{conexiones(AgregarConexion($top$,$conx$)}{Ag($conx$,conexiones($top$))}

\tadAxioma{quitarConexion(Vacia, $conexion$)}{Vacio}
\tadAxioma{quitarConexion(AgregarComputadora($top$,$compu$), $conexion$)}{quitarConexion($top$,$conexion$)}
\tadAxioma{quitarConexion(AgregarConexion($top$,$conexion'$), $conexion$)}{\IF conexion == conexion'
THEN quitarConexion($top$) ELSE AgregarConexion(quitarConexion($top$, conexion), conexion') FI}


\tadAxioma{vecinos($s$,$compu$)}{\IF esVacio(conexiones($s$) THEN Vacio 
ELSE \IF conectaA( dameUno(conexiones($s$)), $compu$) 
THEN Ag(laOtraCompu(dameUno(conexiones($s$)), $compu$), vecinos(quitarConexion($s$, dameUno(conexiones($s$))), $compu$)) ELSE 
vecinos(quitarConexion($s$, dameUno(conexiones($s$))), $compu$) FI FI}

\tadAxioma{dameConexion($s$, $c1$, $c2$)}{\IF estanConectadas(dameUno(conexiones($s$)),$c1$,$c2$) THEN
dameUno(conexiones($s$)) ELSE dameConexion(quitarConexion($s$,dameUno(conexiones($s$))), $c1$, $c2$) FI}

\tadAxioma{caminoDeLargoN($s$, $origen$, $n$)}{\IF $n == 0$ THEN Ag($origen$, Vacio) ELSE 
\IF esVacio(vecinos($s$,$origen$) THEN Vacio 
ELSE agregarAlPrincipio($origen$,(caminosDeLargoN($s$,dameUno(vecinos($s$,$origen$)),$n-1$) $\cup$ 
caminosDeLargoN(quitarConexion($s$,dameConexion($s$,$origen$,dameUno(vecinos($s$,$origen$)))), $origen$,$n$) FI FI}

\tadAxioma{esCamino($camino$, $origen$, $destino$)}{ long(camino) $>$ 0 $\yluego$ $origen$ == prim(camino) 
$\and$ destino == ult(camino)

\tadAxioma{filtrarCaminos($caminos$, $origen$, $destino$)}{\IF esVacio($caminos$) THEN Vacio ELSE
\IF esCamino(dameUno($caminos$), $origen$, $destino$) THEN Ag(dameUno($caminos$),filtrarCaminos(sinUno($caminos),$origen$,$destino$) 
ELSE filtarCaminos(sinUno($caminos$),$origen$,$destino$) FI FI}

\tadAxioma{caminoMasCortoDeLargoN($conexiones$, $origen$, $destino$, $n$)}{\IF $\neg$ esVacio(filtrarCaminos(caminosDeLargoN($conexiones$, $origen$, $n$), $origen$, $destino$)) 
THEN dameuno(filtrarCaminos(caminosDeLargoN($conexiones$,$origen$,$n$), $origen$, $destino$) ELSE caminoMasCortoDeLargoN($conexiones$,$origen$,$destino$,$n+1$) FI

\tadAxioma{caminoMasCorto($top$, $origen$, $destino$)}{caminoMasCortoDeLargoN($top$,$origen$,$destino$,0)}

\end{tad}

