\begin{tad}{\tadNombre{TopologÃ­a}}

\tadGeneros{topo}
\tadExporta {topo, observadores, generadores, otrasoperaciones}
\tadUsa {nat, bool, compu, conexion}

\tadAlinearFunciones{caminoMasCortoDeLargoN}{topo, compu, compu, nat}

\tadObservadores
\tadOperacion{computadoras}{topo}{conj(interfaz)}{}
\tadOperacion{conexiones}{topo}{conj(conexion)}{}
\tadOperacion{quitarConexion}{topo/t, conexion/c}{topo}{$c$ $\in$ conexiones($t$)}


\tadGeneradores

\tadOperacion{Vacia}{}{topo}{}
\tadOperacion{AgregarComputadora}{topo, compu}{topo}{}
\tadOperacion{AgregarConexion}{topo/t, conexion/c}{topo}{compusQueConecta($c$) $\subseteq$ computadoras($t$) $\wedge$ \\
													(\paratodo{conexion}{c'}, $c$ $\neq$ $c'$) \\
													compusQueConecta($c$) $\neq$ compusQueConecta($c'$) $\wedge$ \\
													(\paratodo{compu}{pc}, $pc$ $\in$ compusQueConecta($c$)) \\
													\hspace*{1em} (\paratodo{conexiones}{c'}, conectaA($c'$, $pc$))\\
													\hspace*{1em} interfaz($c$, $pc$) $\neq$ interfaz($c'$, $pc$)}

\tadOtrasOperaciones

\tadOperacion{vecinos}{topo/t, compu/pc}{conj(compu)}{$pc$ $\in$ computadoras($t$)}
\tadOperacion{dameConexion}{topo/t, compu/pc, compu/pc'}{conexion}{estanConectadas($pc$, $pc'$) $\wedge$
														crearConexion($pc$, $pc'$) $\in$ conexiones($t$)}
\tadOperacion{caminosDeLargoN}{topo/t, compu/pc, nat/n}{conj(compu)}{$pc$ $\in$ computadoras($t$)}

\tadOperacion{esCamino}{conj(compu), compu, compu}{bool}{}
\tadOperacion{filtrarCaminos}{conj(compu), compu, compu}{conj(compu)}{}

\tadAlinearFunciones{caminoMasCortoDeLargoN}{topo/t, compu/o, compu/d, nat/n}
\tadOperacion{caminoMasCortoDeLargoN}{topo/t, compu/o, compu/d, nat/n}{conj(compu)}{$o,d \in$ computadoras($t$) \yluego \\
																				$\neg\emptyset?$
																				(filtrarCaminos(caminoDeLargoN($t$, $o$, $n$),
																				 $o$, $d$))}
\tadAlinearFunciones{caminoMasCortoDeLargoN}{topo, compu, compu, nat}

\tadOperacion{caminoMasCorto}{topo/t, compu/o, compu/d}{conj(compu)}{$o,d \in$ computadoras($t$) \yluego \\
																				(\existe{nat}{n}, $n \leq$ \#computadoras($t$))\\
																				$\neg\emptyset?$
																				(filtrarCaminos(caminoDeLargoN($t$, $o$, $n$),
																				 $o$, $d$))}

\tadAxiomas [\paratodo{nat}{n}, \paratodo{conj(conexion)}{ccon}, \paratodo{compu}{c,c'}]
\tadAlinearAxiomas{quitarConexion(AgregarConexion($top$,$conexion'$), $conexion$)}

\tadAxioma{computadoras(Vacia)}{Vacio}
\tadAxioma{computadoras(AgregarComputadora($top$,$compu$)}{Ag($compu$,computadoras($top$)}
\tadAxioma{computadoras(AgregarConexion($top$,$conx$)}{computadoras($top$)}

\tadAxioma{conexiones(Vacia)}{Vacio}
\tadAxioma{conexiones(AgregarComputadora($top$,$compu$)}{conexiones($top$)}
\tadAxioma{conexiones(AgregarConexion($top$,$conx$)}{Ag($conx$,conexiones($top$))}

\tadAxioma{quitarConexion(Vacia, $conexion$)}{Vacio}
\tadAxioma{quitarConexion(AgregarComputadora($top$,$compu$), $conexion$)}{quitarConexion($top$,$conexion$)}
\tadAxioma{quitarConexion(AgregarConexion($top$,$conexion'$), $conexion$)}{\IF conexion == conexion'
THEN quitarConexion($top$) ELSE AgregarConexion(quitarConexion($top$, conexion), conexion') FI}


\tadAxioma{vecinos($s$,$compu$)}{\IF esVacio(conexiones($s$) THEN Vacio 
ELSE {\IF conectaA( dameUno(conexiones($s$)), $compu$) 
THEN Ag(laOtraCompu(dameUno(conexiones($s$)), $compu$), vecinos(quitarConexion($s$, dameUno(conexiones($s$))), $compu$)) ELSE 
vecinos(quitarConexion($s$, dameUno(conexiones($s$))), $compu$) FI} FI}

\tadAxioma{dameConexion($s$, $c1$, $c2$)}{\IF estanConectadas(dameUno(conexiones($s$)),$c1$,$c2$) THEN
dameUno(conexiones($s$)) ELSE dameConexion(quitarConexion($s$,dameUno(conexiones($s$))), $c1$, $c2$) FI}

\tadAxioma {caminoDeLargoN($s$, $origen$, $n$)} {\IF $n == 0$ THEN Ag($origen$, Vacio) ELSE 
{\IF esVacio(vecinos($s$,$origen$) THEN Vacio 
ELSE agregarAlPrincipio($origen$,(caminosDeLargoN($s$,dameUno(vecinos($s$,$origen$)),$n-1$) $\cup$ 
caminosDeLargoN(quitarConexion($s$,dameConexion($s$,$origen$,dameUno(vecinos($s$,$origen$)))), $origen$,$n$) FI} FI}

\tadAxioma{esCamino($camino$, $origen$, $destino$)}{ long($camino$) > 0 \yluego $origen$ == prim($camino$) 
$\wedge$ destino == ult($camino$)}

\tadAxioma{filtrarCaminos($caminos$, $origen$, $destino$)} {\IF esVacio($caminos$) THEN Vacio ELSE
{\IF esCamino(dameUno($caminos$), $origen$, $destino$) THEN Ag(dameUno($caminos$),filtrarCaminos(sinUno($caminos$),$origen$,$destino$) 
ELSE filtarCaminos(sinUno($caminos$),$origen$,$destino$) FI} FI}

\tadAxioma{caminoMasCortoDeLargoN($conexiones$, $origen$, $destino$, $n$)} {\IF $\neg$ esVacio(filtrarCaminos(caminosDeLargoN($conexiones$, $origen$, $n$), $origen$, $destino$)) 
THEN dameuno(filtrarCaminos(caminosDeLargoN($conexiones$,$origen$,$n$), $origen$, $destino$) ELSE caminoMasCortoDeLargoN($conexiones$,$origen$,$destino$,$n+1$) FI}

\tadAxioma{caminoMasCorto($top$, $origen$, $destino$)}{caminoMasCortoDeLargoN($top$,$origen$,$destino$,0)}

\end{tad}

